apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: woodpecker
    namespace: flux-system
spec:
    interval: 10m0s
    timeout: 5m0s
    chart:
        spec:
            chart: woodpecker
            version: 1.2.*
            sourceRef:
                kind: HelmRepository
                name: woodpecker
            interval: 60m0s
    releaseName: woodpecker
    targetNamespace: woodpecker
    install:
        remediation:
            retries: 3
        createNamespace: true
    upgrade:
        remediation:
            retries: 3
    values:
        agent:
            replicaCount: 3
            env:
                WOODPECKER_SERVER: woodpecker-server:9000
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:x7EpEZUQFbT4dqPBctpv2NQKDxs2AlDp8V7+liP63hA=,iv:hHnFMHRXK8mcNBrAIehPJWshqZKMXyoHkHtXs4sYwzM=,tag:7IS2pbfPBITAWkojFUuGGQ==,type:str]
                WOODPECKER_BACKEND: kubernetes
                WOODPECKER_BACKEND_K8S_NAMESPACE: woodpecker
                WOODPECKER_BACKEND_K8S_VOLUME_SIZE: 10G
                WOODPECKER_BACKEND_K8S_STORAGE_RWX: true
                WOODPECKER_CONNECT_RETRY_COUNT: "3"
        server:
            statefulSet:
                replicaCount: 1
            env:
                WOODPECKER_HOST: https://ci.omni.ms
                WOODPECKER_ADMIN: woodpecker,admin,webmaster,andrei
                WOODPECKER_OPEN: false
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:s8tgq7ZgTh9Ap24T+GHMMN0VTNoDu9JgvSOzLiEr0Y8=,iv:em2SKEGRu2fBydgDOKKmq97eMcLgOMyeiVB47JWM3uw=,tag:mPJWHLgwgRAPzIR5wHR43g==,type:str]
                WOODPECKER_DATABASE_DRIVER: postgres
                WOODPECKER_DATABASE_DATASOURCE: ENC[AES256_GCM,data:3+3AnmVcKAbkGkbz+iU81ZO4bfN7AljRJp+7iJOdgQ1nXU+LpBpDQOh1mgn2XMcoWHeEGRBG4GtYCj0B+K8F5ULPVLkrn+/xeQip2gQ4UnEOmcZeNzHoDBRpsAU5q314jBcDzKxer9lLuX8nDr7AxGHAvnox9czagxqMq3/95QOU6FqV/Lvz48pvLHDJIg==,iv:wsFmt5NqmzJfHYEk+6hGV9MdQ0upab16z1SLWFZ3im4=,tag:LtkqEMrjr2HzBtNOi+/h5w==,type:str]
                WOODPECKER_GITEA: true
                WOODPECKER_GITEA_URL: https://git.omni.ms
                WOODPECKER_GITEA_CLIENT: 1fc71f6c-48c2-4334-ac37-4dff1203a7c2
                WOODPECKER_GITEA_SECRET: ENC[AES256_GCM,data:osWpwIVMGPfwRVW89374h2I5k23R+jLbCoAzc/JgbE9V9JOY4yxcODr/yEskdqS+jZ6XqZ2W9/0=,iv:gt94GoLrlKqR/ALrz/gIaiO9PIPY9Lwwf9YBt5dtQ1w=,tag:S87d9tsuxDjb8SWPlKVn9Q==,type:str]
                WOODPECKER_GITEA_SKIP_VERIFY: true
            persistentVolume:
                storageClass: solid-state-replicated
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-14T18:46:52Z"
    mac: ENC[AES256_GCM,data:/hmFtnnZSQ3gOTYSQrxMxv7QtsHtFH3IIC/CFF3AfVGZiXARgSi3OfrupnBKjVr7fOWoGZImRgAzOxdjxTRcC0hLnIWzFAyVfVUrwPEFSVhpiTQfkEfw57NE7jjvO7GLa8hkz49XO9UXgpxkS+KJJSFNyDj+IHtz+1Y803wWhP8=,iv:vHJtok5LCPC1shymUsJEJYFl5s5mwtUpyfSjeWpYfUI=,tag:JVkGWj2+eqUJDava8B+Jqg==,type:str]
    pgp:
        - created_at: "2024-04-14T18:46:52Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMELLRhvEMVZoFYdWzsUFPZCcv+Nv/WbzxlU0KsbS5LA4xO
            RcMVgA71cJcztIlD4uF7CCfUQ/vpmbGMbqluco3d8u3cUaWopAgQY9BdJFuIu7kH
            cXGu5ngaTSGeTbjMrUYFML5YiXvtRbpgBTPST2lOwkYpT4f+nrg+I3iObWBmBpGe
            TZxGNkK5LavqmNHbzRFV0NRoAQkCEEIZ2RgS6KX9f2djV6LsTjdPjNsQ4NwqZkHM
            BzMIGtzRqKYFmtN1UCWIHemWjKcLFipbjh73UztJOxiL/y6PH5AFZN40TrnPJK7c
            53DP+85HPW7UKLmaY9xUPV1oIQRfRMyFQtE=
            =qCNH
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-14T18:46:52Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwME/kX+26lAnl3SII35cJS233ejQ0TnvopcFQSEIYSOcE6r
            iyMfA+kqKKJ+XXWvAbLtgSqHwGFE0PezVkjbo81XFxRX6UNF9TyHdmYcrsYzSzsl
            DL6QbayXZZlkGrO8st9RMNYGxlOrXsYDkstRUM1mYm7JCHayWS/jJ2RQKwwsaUf0
            125/SsgfFANmygdE7ML9fNRoAQkCEI8ZJuvZAQewZDJFXi4+1XDu02Ul+zj52RAc
            8VyRAQ0F0wgXm/ImOY+HphuLfy4vwi5QMA7BfR3Y1j5G+mUHbJOsfF6DRnOyTRbC
            NBltlzvNKdItlXIVFs3E87HHde480MICTtA=
            =Ki/E
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(WOODPECKER_AGENT_SECRET|WOODPECKER_DATABASE_DATASOURCE|WOODPECKER_GITEA_SECRET)$
    version: 3.8.1
