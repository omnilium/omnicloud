apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: woodpecker
    namespace: flux-system
spec:
    interval: 10m0s
    timeout: 5m0s
    chart:
        spec:
            chart: woodpecker
            version: 1.2.*
            sourceRef:
                kind: HelmRepository
                name: woodpecker
            interval: 60m0s
    releaseName: woodpecker
    targetNamespace: woodpecker
    install:
        remediation:
            retries: 3
        createNamespace: true
    upgrade:
        remediation:
            retries: 3
    values:
        agent:
            replicaCount: 3
            env:
                WOODPECKER_SERVER: woodpecker-server:9000
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:yG6/wGvBRukKIpGowe1Air3anEmp77LhzzrR22gakLo=,iv:kPaYuVGnJo5VhCPJZxCF5gfUf/jquvt2PBrK26KOJAk=,tag:u7UmZfJU7fKkgjfPhgzPxw==,type:str]
                WOODPECKER_BACKEND: kubernetes
                WOODPECKER_BACKEND_K8S_NAMESPACE: woodpecker
                WOODPECKER_BACKEND_K8S_VOLUME_SIZE: 10G
                WOODPECKER_BACKEND_K8S_STORAGE_RWX: true
                WOODPECKER_CONNECT_RETRY_COUNT: "3"
        server:
            statefulSet:
                replicaCount: 1
            env:
                WOODPECKER_HOST: https://ci.omni.ms
                WOODPECKER_ADMIN: woodpecker,admin,webmaster,andrei
                WOODPECKER_OPEN: false
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:hPUfm0MSW1zzMrPKyfzSjeplQqmfNZiUiIsnI8C1Ug8=,iv:l9KVK7z1rp3sMSi4k2OjG08XyHvaKafuAr3nomf1euY=,tag:dPNaJEWPq30OzSvkYk02pQ==,type:str]
                WOODPECKER_DATABASE_DRIVER: postgres
                WOODPECKER_DATABASE_DATASOURCE: ENC[AES256_GCM,data:fPnHdCnW5xC0qqXsciFInV0T4JUXyUcv/snHBocZoiSOr0s71dA0H2zKrgZDvbayaShI7QKpct8nIr0smeek39xTr5jUK8NAnxDlW5wESTof+AEcYBvweWygJp/4Xel1+A20J+3Tde4iNuGF/b8gp613QK96hdpBUoovVRlzQiMEAMpu7te//CdnkJSQBg==,iv:q5RBjAp7M8gXTkkrdXOh1tVabtIV3cXcKRjMFFJe768=,tag:3ZE+jw3ARtU0ZsDZvc/zzQ==,type:str]
                WOODPECKER_GITEA: true
                WOODPECKER_GITEA_URL: https://git.omni.ms
                WOODPECKER_GITEA_CLIENT: 1fc71f6c-48c2-4334-ac37-4dff1203a7c2
                WOODPECKER_GITEA_SECRET: ENC[AES256_GCM,data:+ISBfyVr3hpJvMKVViuaO6rffg21IIwGDuymrDzzyyVDUYBU+2Vh7YEdm+U7KyT2gGhD9IohpLs=,iv:GDA970bQcLyf3+U8i4ACDZ962GuvJtJDvtBzmkAmiYU=,tag:1UTIKcvUb3xUP+YLVPaOgw==,type:str]
            persistentVolume:
                storageClass: solid-state-replicated
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-14T20:58:21Z"
    mac: ENC[AES256_GCM,data:UEyZBldgTv+cGYuEgqueMZilRClBJcUaDBTkA2lI8VZwuB4N9TazevLLFEdad3c4qyOt3cqaqmxKTs4ZejpxrU+5T2NabhDyTdvIkOXoN1h5bjL2nvj9a45VZ3LArfx89zJSbEvto2otQB5KUZBVpCTMGuF9ErW/TWDkmz28zDk=,iv:Rl/NWvtTAVJD3JHFBLOj4H+/PUH9CXpYnLZyQ3CUJQY=,tag:7dKO3TcER8Q2Et2i3AmOzA==,type:str]
    pgp:
        - created_at: "2024-04-14T20:58:21Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEEW5TmzFdbYdcHiBHReavu77kU8HsBVT4O//S50rVckHE
            2WwcKCk4YBbqaBqVO9IW3yYV3nzs1kg1pTMcGv0OnRXvg7BT17pQITILa9+GzQwv
            xR2DLDv3ljZqAJlx15ebMJMdJ6pmFWG8zTMgLy2QMC6KjmcT8OBnqPuiEum5fQFA
            UN5qInLH7q8WdyZzhosgwtRoAQkCEPRIkwQqrLgh2hrSSX6PcJNIAEmVYMvNlL33
            1NXa4Pvd2qgvl4zRhBgHAJZh7QTTHfmz9RRRVGPphIDn+7xAlt47C27Iq3Hpf1OO
            pP7avSrXW0gAN+W3x907luCuS+U9s+KMNjE=
            =SBAk
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-14T20:58:21Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEawWp2BbMSxWGQi+UsgVZZmgte7AD0QZyKREXqftC8h6J
            ZB1TsEgPubHnVJYSAQKZUUwhUjyrVeQcYt1WqOHZl8MfgF72d6kbpkr+eJ2ku4Ka
            9grL/FVemPukMYml2yIpMDi02k6f0FR53ueC7SiBKlF/oWNz+IL+k+7IHxYxUiEQ
            5yUiy4P4/D4731fKRA7MctRoAQkCEBe1kCkozK6te1qqlwcK/uSwnWBNuUV2VKCT
            OdDGagTaXAcSyslAk4HCSpgpyfkIt/WqE0vFUAJlyV4TV6WfeO14PwuNVlJKLHnJ
            Rp8zIffZHGcjHPTFgs6bPUx1fKDszaj+MZc=
            =LZiU
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(WOODPECKER_AGENT_SECRET|WOODPECKER_DATABASE_DATASOURCE|WOODPECKER_GITEA_SECRET)$
    version: 3.8.1
