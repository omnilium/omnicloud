apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: woodpecker
    namespace: flux-system
spec:
    interval: 10m0s
    timeout: 5m0s
    chart:
        spec:
            chart: woodpecker
            version: 1.2.*
            sourceRef:
                kind: HelmRepository
                name: woodpecker
            interval: 60m0s
    releaseName: woodpecker
    targetNamespace: woodpecker
    install:
        remediation:
            retries: 3
        createNamespace: true
    upgrade:
        remediation:
            retries: 3
    values:
        agent:
            replicaCount: 3
            env:
                WOODPECKER_SERVER: woodpecker-server:9000
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:eZ+xCC08vpHPol72FjCs6TVqbbcFzmVu9W1pjHUjv/E=,iv:8o440MHBri0u9ghgi/I3cBOvK3JtpC+uyb/ibh6Wgfw=,tag:DzdkO/RaaTH+6d+4gBLYog==,type:str]
                WOODPECKER_BACKEND: kubernetes
                WOODPECKER_BACKEND_K8S_NAMESPACE: woodpecker
                WOODPECKER_BACKEND_K8S_VOLUME_SIZE: 10G
                WOODPECKER_BACKEND_K8S_STORAGE_RWX: true
                WOODPECKER_CONNECT_RETRY_COUNT: "3"
        server:
            statefulSet:
                replicaCount: 1
            env:
                WOODPECKER_HOST: https://ci.omni.ms
                WOODPECKER_ADMIN: woodpecker,admin,webmaster,andrei
                WOODPECKER_OPEN: false
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:CIrD3lB9aQ76SWMR0roU28X+/n3ieiysAuA+4qcrN6w=,iv:x7NgOTmiu1qf/cVWcQXoJAxoyaRtE1ya0yTtW+OV5Os=,tag:WMxk8GXZCShz0BwawUOtFA==,type:str]
                WOODPECKER_DATABASE_DRIVER: postgres
                WOODPECKER_DATABASE_DATASOURCE: ENC[AES256_GCM,data:Bbd7KL/FH+0hgL79yrtdV3xyftGK8YYHwr25zw6Uz4Tpmh94OBU1QLCmbk5L+Ls2BjetqlTHjfDuS8qtSKsmTTOgebYVo1y//jIxyhdVcsc3ea4jqBc+ubR7i/8I871HaDK4URgB3T+ogGOqgEmMChse6x/Mqufb+Qeov9CPJpzq6A8FmUMrFvQc//029g==,iv:d7U2lzr32a+7QNzc/3I0S5Z+6HlxaTR/SgX1WHDQc04=,tag:vN8nkw18aemr0iEdYf4Dfg==,type:str]
                WOODPECKER_GITEA: true
                WOODPECKER_GITEA_URL: https://git.omni.ms
                WOODPECKER_GITEA_CLIENT: 1fc71f6c-48c2-4334-ac37-4dff1203a7c2
                WOODPECKER_GITEA_SECRET: ENC[AES256_GCM,data:vf8T/W8Y2FTzfBQjsayjir/TiPnyKo6ItGhQQ/cMUiCfOnslrZkBLec352kVuguG1L86h/auJfs=,iv:8ZUwZlTTLZsOOJM76joIaDYn5ZyqJAiuJtqYL9EU6FM=,tag:wnrMRxpBr6BBlO0t0KTMTw==,type:str]
            persistentVolume:
                storageClass: solid-state-replicated
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-14T20:37:23Z"
    mac: ENC[AES256_GCM,data:9XNvDvK4bpEiRE+cRnGC51JpISqbHwoVWxtlJA5Qtn+U2PfDMkpK+BByAJIiOpo9GLUkE8rgAyhMjFEW37I3c900p0XIVfF/UzIyvXHN5rX4Oni1Nhw672cLevFSBB5i3C5jSKDfNWaWejnUje1hbPxPS+j4cJ3e2RnRF87eTkI=,iv:r0hb1KhSGrcYL9F44Kc51LjMtjOkakqs2L+qrcngh6M=,tag:0zTrM5JVkG5g6fcnP59tMQ==,type:str]
    pgp:
        - created_at: "2024-04-14T20:37:23Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwME6cNsxYupnDtVzxeyo3fvt/8H8vxUYNAfAuyVtFICODrU
            Hl+fSwS2oqQycyw9l8cq/weqYrGkmvTIDvT8VRiLqNbkS1mpnhGICBwxALK2Ttco
            4Hz27fGbWBxNmw97jhnKMLRYfpVEDLUc6TjMziELvAhUYZv7H1NhDeaX3xVduyL7
            F3PtTTpx38RMimD85s5d+NRmAQkCEFy0nR6BVyjfptHsdxhHcF0UKhoQQ4aYTZNU
            leaeINyC/bx8V2G4kfrOvTHy2jtTWM2y5JMexBZ2ivp6oaW3XTVpEG5zIwlhNEc6
            /8v8pULjAbQpLqban/kjua/xHQX1f69d
            =UNO4
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-14T20:37:23Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwME5UedamX0WGxr6SOWs8Jxnyc9ETui3+k4T1gowJ+bY0y7
            yF/3fb0QrKIR02HG3CEAbAjLUMve0jjh8MNRMI+ebxLx6Ew5efVREwRkofXbVOPd
            L+vwFzDqS3eootMMvAP3MD044shtkDd55fWfjpVwoY8CkfFhoz1o14wlgHNSPfw6
            f4rMm9HZsqRGYVuQ0vIYZtRmAQkCELkDCYlXHgJd2J9I0hpr733nOpg6mHuEEtLp
            V5Huq8g87MEFsFWCmfgVe1UK6ra1qUadAI4udwsIBFJE2bgLe5mCUCy4YGt9kO9u
            PrJDHmriePnBGReZAs+DACXbMvRkre34
            =wRI/
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(WOODPECKER_AGENT_SECRET|WOODPECKER_DATABASE_DATASOURCE|WOODPECKER_GITEA_SECRET)$
    version: 3.8.1
