apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: woodpecker
    namespace: flux-system
spec:
    interval: 10m0s
    timeout: 5m0s
    chart:
        spec:
            chart: woodpecker
            version: 1.2.*
            sourceRef:
                kind: HelmRepository
                name: woodpecker
            interval: 60m0s
    releaseName: woodpecker
    targetNamespace: woodpecker
    install:
        remediation:
            retries: 3
        createNamespace: true
    upgrade:
        remediation:
            retries: 3
    values:
        agent:
            replicaCount: 3
            env:
                WOODPECKER_SERVER: woodpecker-server:9000
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:Gpzxc+KSZovsD0b3/Ch4yOZBppjI2czQ+Kzm0W/Bq+M=,iv:vONJlqFA2CyDhfGsXbJ7xjzgkhWZ254tUdcHqGOLqAM=,tag:tRDxmruNWNPL7H1BNEs7gA==,type:str]
                WOODPECKER_BACKEND: kubernetes
                WOODPECKER_BACKEND_K8S_NAMESPACE: woodpecker
                WOODPECKER_BACKEND_K8S_VOLUME_SIZE: 10G
                WOODPECKER_BACKEND_K8S_STORAGE_RWX: true
                WOODPECKER_CONNECT_RETRY_COUNT: "3"
        server:
            statefulSet:
                replicaCount: 1
            env:
                WOODPECKER_HOST: https://ci.omni.ms
                WOODPECKER_ADMIN: woodpecker,admin,webmaster
                WOODPECKER_ORGS: omnilium
                WOODPECKER_OPEN: false
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:tFJoNrOA2HoBln5zPeT+B7at0JwkwT323Tpj7F10nlc=,iv:GmDPJIdNorBksifECVPr68F8NkfHlFbg08981eq2xvo=,tag:Rqb9sWW9mSspkEEtOhjj5A==,type:str]
                WOODPECKER_DATABASE_DRIVER: postgres
                WOODPECKER_DATABASE_DATASOURCE: ENC[AES256_GCM,data:GJDAAl2QeAF1PMRt5zUMy5pG0lvpV7uyak283jFmL0SBYPZt8FF/xbBPWeP31VbcPkdDzSPRqJ7eBO/dmt0EGZ3R6zPpmp7zTATrRPMDWaYM5KGVyqPt4c3c9TzlVa3x6JZbvfPK5ZHe760dR43IqhwAAc1pDIWcDMxl3rhM381fjRyZYTm/YaVxAxTVyg==,iv:t+7IXf+gAcYDiF+Q959/uSlY5XN/2pEgQjzlk1otxDs=,tag:l0GCOZlFC54AFT23wRBDdA==,type:str]
                WOODPECKER_GITEA: true
                WOODPECKER_GITEA_URL: https://git.omni.ms
                WOODPECKER_GITEA_CLIENT: 1fc71f6c-48c2-4334-ac37-4dff1203a7c2
                WOODPECKER_GITEA_SECRET: ENC[AES256_GCM,data:1H2DojQl2wcTuq7T2325DnBD8egZyvUUlFW+8Au6CqGzpKlgEboUDuHh0YqDL/rdL7FTmizMBCg=,iv:koJ0+Gmrjh2yqH+uKPgR11eNLO3u5v7Xih/3brZC+Z8=,tag:iduPVTMXTAxlvBZL+ohTBQ==,type:str]
            persistentVolume:
                storageClass: solid-state-replicated
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-14T18:34:13Z"
    mac: ENC[AES256_GCM,data:ZB/ZR+5EIRtqXrusZfeWc33o7Wk3khgbbYiHMcfqKaUfZz/NJl8cULL5PwrPimh7ZZr+UxGhgJKQZw5mIQZu8tMmz38Zl/K3twYAxRtGJ0YGg27OROTW3XmycuE6PaIS/4CQ0KP8oTmi8mEAY6b88fcnB1c0z+6W0aCxG5cT4Jw=,iv:vv76SkoZeKKVFQbaLq0N4ue79q3rwAMZPlqkrU2wFTU=,tag:xcy+nmql9kDG+LTyewOCKw==,type:str]
    pgp:
        - created_at: "2024-04-14T18:34:13Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEXUqTb764dBrjB6IRb5W1rZkckMx9ABscA2c30EQa3Bpz
            MteFG1U9OK1yNiQq/IIiRzyQiALTju95rpNOZR6xHzUbybO0iokpv1PuhnEWKf63
            nVS8zJJdaN0Y7WyPlqHAMKRvVcJexCXMo4UAHQdUuyaHDngw5MO4ZB1ezRDpLy2K
            jjnh7e8950UXMwVlJO17/dRoAQkCEKcxUUdVSEjKr2TUkus/W2p8sG0Gc7iXcCJ7
            /CzjppssTF0bl3jm8p1FEfszu0TGwZ4e1WpVeousTor6Jbmb23Vwy8zVVjA5kTn6
            8k1DZTpeTYfG+geYoUpXRhVaN7Ti6DfOoqs=
            =KSZD
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-14T18:34:13Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEFHxm2ZDh4QC064mIwbqhiSevzkuaTN/rFYkWsrxHPOzX
            RkuOwbe1UizQJMGbPV6LExixhPJmj6+u8kPs0NRNbJqnBdcyt/serooQUHzEhNaN
            SA09/3cZ3kmtidV6rDRMMG5QqkFtMN4+iGLhAsONSBUax51n3fMoSRbUfUw/ruV+
            zAPO8BMS4LpMoKk90ih39dRoAQkCEM0lXQoRnNfRHBDiTL8rnPyRsJb/M+IuDiHO
            tjg7aXWE+Jy53Wn+rU12O49hnDd9/QN9uFSQgu9GBnfvbAxO9j509sAEivo7xmmK
            k6g+0YBXo+288av+33hqAUP0SGSH7GqmCVk=
            =ahvC
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(WOODPECKER_AGENT_SECRET|WOODPECKER_DATABASE_DATASOURCE|WOODPECKER_GITEA_SECRET)$
    version: 3.8.1
