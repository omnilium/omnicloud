apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: woodpecker
    namespace: flux-system
spec:
    interval: 10m0s
    timeout: 5m0s
    chart:
        spec:
            chart: woodpecker
            version: 1.2.*
            sourceRef:
                kind: HelmRepository
                name: woodpecker
            interval: 60m0s
    releaseName: woodpecker
    targetNamespace: woodpecker
    install:
        remediation:
            retries: 3
        createNamespace: true
    upgrade:
        remediation:
            retries: 3
    values:
        agent:
            replicaCount: 3
            env:
                WOODPECKER_SERVER: woodpecker-server:9000
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:RlOQl3AHV/6pRcLXpc7mkXC7YMrzAmC7TGCZjG/D/TQ=,iv:GRzIH3RZs5MHG7KAYO9en33Hgt8DFHJJ9eSBhqA7TZA=,tag:oR3PwSMzb09E4rA+Aq+iow==,type:str]
                WOODPECKER_BACKEND: kubernetes
                WOODPECKER_BACKEND_K8S_NAMESPACE: woodpecker
                WOODPECKER_BACKEND_K8S_VOLUME_SIZE: 10G
                WOODPECKER_BACKEND_K8S_STORAGE_RWX: true
                WOODPECKER_CONNECT_RETRY_COUNT: "3"
        server:
            statefulSet:
                replicaCount: 1
            env:
                WOODPECKER_HOST: https://ci.omni.ms
                WOODPECKER_ADMIN: woodpecker,admin,webmaster,andrei
                WOODPECKER_OPEN: false
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:s57sU68HMf3Vc8zUqSVNkCngWDNo4RybwIGRSGL+QmE=,iv:SsiLiZKnli05tNUQ7RGNTZzD56f17X6SmVprpghmDNk=,tag:v354PFXYQcDEgdZtjzGuJQ==,type:str]
                WOODPECKER_DATABASE_DRIVER: postgres
                WOODPECKER_DATABASE_DATASOURCE: ENC[AES256_GCM,data:fhdUdz59T41vFmAdoe9lutolpp8W/BVZAx0yKfZTe7pECV9W3VscPYo9vFq3nasHDniMvY10Gg39GSaSko9qkcDwiRS7v53uJ8+vJJig8DflDAG5gcfvN8oMl+IcEJiGFMqC9cmuiRnFFNMJHsPzxq8mAhps3pSPwQIT069Ke+b5Ah0KjeW3Aaf+4UiFoA==,iv:3RdI+Y0BPSUIWJc9MGXuFqhshwYouBVDyoPzlYq18cQ=,tag:bhtxvLiJqD5StzbXOrmM7A==,type:str]
                WOODPECKER_GITEA: true
                WOODPECKER_GITEA_URL: https://git.omni.ms
                WOODPECKER_GITEA_CLIENT: 1fc71f6c-48c2-4334-ac37-4dff1203a7c2
                WOODPECKER_GITEA_SECRET: ENC[AES256_GCM,data:QSJ+hYkBg8T0Oms7DifExB+M3gcwdmizLd7y65slsV3m9wTvvjg+qzD7NROXlS3/wvbUH7RmGuc=,iv:63RkIguN7Yx0VA9S0PaJBUDG+uJ2fTuQPcr2hIML9XQ=,tag:YRK/5FYdwqhkxbLgHG7Y6w==,type:str]
            persistentVolume:
                storageClass: solid-state-replicated
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-15T07:49:16Z"
    mac: ENC[AES256_GCM,data:Sw/jEGaAjPJaBWlOP6sbEGDjJsaXmDQCFDjOom7t56ecdvRz1GFTeinIzTCD88TIPCxM62+9l28g4jE6+plinLe6pIVRd65GnGso7xum0prwOTowfi824QsHacbP19pJz/jqpSo0kZdMBLmTYH2fNeRyKM143tin/qWkE8CNXeo=,iv:EAfNXnXL1RkdB624VlqXvCxB4H7/txWVpQ+KpUcoEs0=,tag:nBKu6q+DUCWnBfV2DmwEAA==,type:str]
    pgp:
        - created_at: "2024-04-15T07:49:16Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEo9+h9TOrgSBU3S5Oym2agOmKI2BgI7//J1Qp9P3YsL4s
            fZ1d4UD6yCr1bk3uYE0zRAspRMN3adxfk7k27enCCD7C7fTwohswv8o8JXb5cL9H
            ja5zNqqQqpiqpdREMRjMMKDzn1Xo+CfygHdO2P7kvf6tTPf9egfC8c+5H30q6HEL
            YG9R1eW57Yz++pqCVRdXb9RoAQkCEBYWn3HLiIUXTgFy20MPobkyLZRBf72expLx
            2kVWsYOl+Bqqx+r1Ufv0v36VRB64LddHtfkj3Iq+2RyZSr6+wyHfOI4nzVDB+nKF
            3AoGE3Xf/Mrym6TAbOOuHqroKm5MF/WHfs4=
            =eBpF
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-15T07:49:16Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEXmip3/wwfunHbhT+gI10nPH7ZxEHDs1XXl6lJ/TETocI
            GJkpUS2JtwnfU8MpIAHIyhiQV3MR3VdqOkcy48Ro1yHKE6nflMrUO2s9WhdGqJyE
            hMEhEEzw1yyPy795ZSi0MD3W4FoXUr8P1Q5gVeZ8d/GI7548R27IAiEfGDYzetiz
            VeFXSWPQDOZPkNShLdMbBNRoAQkCEDUu7Gm+lWsTQJcwwXY8qCCgOChcC68BaASk
            uzbpBo6PQ7m4wksbrk566Lfj0Je82QceXMJ0NPDsCcdhS3s/LDG8e/SEiM4vA3PG
            kvSTHrZwH9cAnzxLf46O1oz7+1Uqa9hIQSg=
            =N7oQ
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(WOODPECKER_AGENT_SECRET|WOODPECKER_DATABASE_DATASOURCE|WOODPECKER_GITEA_SECRET)$
    version: 3.8.1
