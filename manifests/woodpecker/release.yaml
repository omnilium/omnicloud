apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
    name: woodpecker
    namespace: flux-system
spec:
    interval: 10m0s
    timeout: 5m0s
    chart:
        spec:
            chart: woodpecker
            version: 1.2.*
            sourceRef:
                kind: HelmRepository
                name: woodpecker
            interval: 60m0s
    releaseName: woodpecker
    targetNamespace: woodpecker
    install:
        remediation:
            retries: 3
        createNamespace: true
    upgrade:
        remediation:
            retries: 3
    values:
        agent:
            replicaCount: 3
            env:
                WOODPECKER_SERVER: woodpecker-server:9000
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:UzG0izDoeTDEjoaUGJrWdvMrU+KuRwy8xAHfzZ0JrR8=,iv:dXfcx/VVPxzPOFi+gJ1a4pY7AWltC3Gq2Xp8sd5Ih+o=,tag:AaAfIywRa7CEpFgcRnf0Pg==,type:str]
                WOODPECKER_BACKEND: kubernetes
                WOODPECKER_BACKEND_K8S_NAMESPACE: woodpecker
                WOODPECKER_BACKEND_K8S_VOLUME_SIZE: 10G
                WOODPECKER_BACKEND_K8S_STORAGE_RWX: true
                WOODPECKER_CONNECT_RETRY_COUNT: "3"
        server:
            statefulSet:
                replicaCount: 1
            env:
                WOODPECKER_HOST: https://ci.omni.ms
                WOODPECKER_ADMIN: woodpecker,admin,webmaster,andrei
                WOODPECKER_OPEN: false
                WOODPECKER_AGENT_SECRET: ENC[AES256_GCM,data:f0FqTmOTk8TFMQCQXNE2gPv1EcdDfWmsZw1xKn4rdN4=,iv:Kg4U7637QTkaNBOIj+Iacqs+4/xsN8D35kns6ogaqEU=,tag:Q3Yp/cCBCjrbQfA3jG7IMg==,type:str]
                WOODPECKER_DATABASE_DRIVER: postgres
                WOODPECKER_DATABASE_DATASOURCE: ENC[AES256_GCM,data:5hEx/lZBQN8nnoU+3s5pkR+lCJeZhIGV5/9dPiDtnE0DByQMUWcuP5ma98l0bIM+RiZ3y63+nXW5B72xqa6y9V69hfF6lsHfumy2w6jK3XujDduQiXn+jo+jXuEIBE9Ls1V9hcUPKMD0dzWp1YHYQG0JYzkz9EVVrZwJS3/R2CoXmjKA7qMmzaN/cUSJiQ==,iv:WUZe+Y/jCXRY3xiLm0kLRJ5YB4UziuM57gs6BGz+H7M=,tag:73125851rXBpX0Gxtc6HvQ==,type:str]
                WOODPECKER_GITEA: true
                WOODPECKER_GITEA_URL: https://git.omni.ms
                WOODPECKER_GITEA_CLIENT: 1fc71f6c-48c2-4334-ac37-4dff1203a7c2
                WOODPECKER_GITEA_SECRET: ENC[AES256_GCM,data:I5PqABwLEFTWDlojyxT7+REi7Tm28TpUvYy9pueE9waU+d52sENxY8euUS0sq+XpcrMOiYbIrGk=,iv:T25ydLcH5HeKqZzTFg65weW3kG7rDk178y997hhB9eE=,tag:hHqXMoDjZluJWNxQjh4cBQ==,type:str]
            persistentVolume:
                storageClass: solid-state-replicated
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-14T21:07:25Z"
    mac: ENC[AES256_GCM,data:PPWlOmWxWHERUvOVeEJKxHv3acQHvqvw6bp8HGTAowEGNqoEGY39R8tvxelXw61t5EPWxc1dERL3qCGseBeelqlihj7M6CBU8sLjR2tPy/jC3oBJLRjyNoS2OtpAt/5yp/QKPoxcms0hCysqyKFD/3yRGejwt5Dx+e+y4DlvEMk=,iv:iWizESQ5Op/61XaqFeyLw17e5owbVTym0xgdD4CHxhg=,tag:KlWI/aEoH/ljMVei+Po1jg==,type:str]
    pgp:
        - created_at: "2024-04-14T21:07:25Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEcL6uGPPLpd95RFlBvp0zKQKb0+PzCmzb/z4tWFU/EjEO
            vTNZWGTOVoiQRPEyN8G3N/OZzREjtXsv1vJgvGfcFmFD2UkZak3JxHBAtCC/LL3N
            6DRWRW/XdijhekwUKxQsMNbT2VM0VOz71sHwJaGPQkghFc6A/HfQmZCSiEX20RUn
            m3DyIMu3gHz2iMdOEbQxtNRoAQkCEB9moG21F9oEIbY2F1D+H/UYZdYXCoXaRVqu
            w1v3ZH/H4LSZWr0KIBYcctkPPm3/Vbl37qR4SVH8yGq2OQEKLfAWrRWwdcx6lEfP
            pqw25RxbnlSHq0wDmqKwMcCt4GmdnRnnwR4=
            =Qkp8
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-14T21:07:25Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwME8bLumJvzcck8kuvM9g0XVXt6WcHfs6Ty3QvG7kqC/h0o
            o0HFpqHfi6VsuP0ATzCCAL35mrIu0zjk88XRKCFq7z99AcDR2q4rhaTO7SaChZco
            zZXzVVeI8uGbm9fcCDfEMNrkoZxfCf1Hdje749mJFCknZ/yAVfDi+XFaRRiFMSnj
            iDwGj3in3RElxxmAky/O8NRoAQkCEMr/sFoaNRdvi4U98MDzZIWpd9HPkPQjMQPb
            9P0nVfQWQskET/aFVRyILajKoJ/xNetLP8bcgnGPwQQHbfjo9rqlb0GOnHD9Rh/p
            WtnIW4Gk6m7QXNMmzKukfrfTyFH2SMk9gCg=
            =uQhw
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(WOODPECKER_AGENT_SECRET|WOODPECKER_DATABASE_DATASOURCE|WOODPECKER_GITEA_SECRET)$
    version: 3.8.1
