apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 1
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:cwXWhufQyDSiVjAQevHxODuMMUMzLfrB78iNNADBa08=,iv:If9R1arVLcqwxluMc5yhQR3ZAb/nie8gVMLy5DenoHw=,tag:x2KWGOGPWRZxePgkiw4jBQ==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql.onedev.svc.cluster.local
            port: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:f+c9M2Zz0h1ehfvVsVonYSCq+KaFxgnixarIQc1kPs8=,iv:0AD8Ofp4aOcTYqEARaMIXGC2BF6iQr9L5qMRhIdK0VM=,tag:TEtEjKXiWEXP5WyBLEKyhg==,type:str]
            maximumPoolSize: "50"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T21:05:45Z"
    mac: ENC[AES256_GCM,data:Ez2WuKbCzRfu9yAeZ95dgxFveKQ9NFfXgNRxM85C4y+nL1CUNAnPssckIdMRZ1kHkzx2Xa/V2Iht2yqiNb3wzAP6R4nIwOi/IxzIAVknw4i+FFX8EBBiqYFsl80Lh/Y1KwugQXbZsee3jVEfZpcf6nm9qTL3gVaz1PEhxYvDbXI=,iv:oAHg1hMiiFSWb0eaKHf6CBfTcu1JcjhvWfP/iknmi0Q=,tag:iq3ecgdIojNvAxkrIESRaA==,type:str]
    pgp:
        - created_at: "2024-04-07T21:05:45Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEv4E3nfXUhZ82Ggf7tlRY7d7TZ8Yuhx/DSEhA435EtsIp
            fT94QmaFqdv7ri3sssqhba6hhQyrcVXUUggkCmw7UyotGzwC3BEiT/XhyX8JMC5w
            IYhx/83mdsBkOI2LMvoQMGXPefNySTvOEJb3/dTCmyaRDzQcHHhoI6SNlfSBHVr3
            laE7EOVeD5dtfK3RtUR28NRmAQkCECgv7ODVbyemQzvJ20g86F64PxkKOmSJXvbW
            VjKo9M0ImnQ1NWsX0KKMM8PO3bygUFu80/yBvL62C18R5zSZnrOWFBcX1apY5QUt
            ydMm77WWBV7lOGT45rMPA4G6t3vgOZs5
            =KUgg
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T21:05:45Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEwnXZY/lLksrfLpLydGZaqukCCr9F9gXU0N3Pgly7mJFt
            6OwJ3XqkYf0/OZzsy/2JcX5rsz8M8nwXtxmZSJofEQGQcIaM1RsNYAdt3pl2bTyh
            VXImUuzsZWKsX02pG8T+MB/EWlXtmdjXWEp1/qFxCRX3IpxeJjzN/YcwdfAV9PUO
            wBdWhHL/dOfQyunlXkqSD9RmAQkCEN92InVrxiHHewyvJAioOCl5BnnOUr5jIkti
            HL1uYJ5ETtuqmFrmU4ULcbj6oBeU6ujIqkw5QiBEJmXTuSdF5bMYIoc90Jt6w+D5
            vgNrQsjzpNuL6+aHneYThOclVcw4P04G
            =+OCT
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
