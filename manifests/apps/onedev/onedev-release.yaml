apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 1
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:IWu+MxEwsqJ4HkIlliyFOrk8BkJ7YeCE6RfJG8kdOEI=,iv:ogpQ/ny6pHAlXSrj0fNKxuc4qNDgYUBOzj2rHbbTsRk=,tag:i/HR/+6xs5o7QgQEgD11jw==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql-ha-pgpool.onedev.svc.cluster.local
            post: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:mDj2+y0AeoueDNo1G7/PvcQds929ms+S08HV6HGQABI=,iv:wvGoK9UKUQad9bIgNuuGUz4fa+7fnSTAdK2WWlf3gZc=,tag:TZ4TfwH2sF1nWgq5VS7yKA==,type:str]
            maximumPoolSize: "200"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T20:38:42Z"
    mac: ENC[AES256_GCM,data:ViZhVoXevmsYs4BRHIalahTDSsmO5q4/vluGpMy4bNbmovdfE8hDuCbt4HjcbR7qB8gwAsT+86EzwigY6aavls9z6SqLB5OiCjuFGZ/T5XwVuMilTlyx9x7bCD5KsaQ2Ge+a4Kb0DHpFbJoWx4E8A9yNiStGrVHo9/GTt1NF3u0=,iv:M6vcSDKOKmR6tOeNToMcmMgbr9lXtBWUWAWl17vXVx4=,tag:J3WUJUJdCavSaSULvOv8ew==,type:str]
    pgp:
        - created_at: "2024-04-07T20:38:42Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEw4FDZ+Y6KTfhqwMeet45W36SIawR7c9K6vKKB9OZ8E9H
            b/8KptlylNbogyKlX7uKmPGhKlJ1Fbw1F2SNfuFbYO+Cz3o1gtoUjQSappjDPe6g
            0qDTobv+TwUybzTQp6EdMCuaM5EZ47fvq5sLagpIyvgs31aJWHUbf9zZEkLHUaB6
            j1hGQ2HcJgziJa6JHoKaZNRoAQkCEIfKhuSE1HnAPvratUQKhMir1QFrZtU1tM3l
            wQ1C99i9dix//o16p3Z/t2BsiojY84HIU79/C0lt6D1t1Y8yIbLvjMCQ1vNfuJ5o
            JvNTOy11cHGDFAGgS6BZ686PMNs8h2tXj6I=
            =g453
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T20:38:42Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEMt0CHWbIgi+oXEdWsJ9uJTxF+Si0N1Y/gj/uyj+dDw6+
            +pUT8FSjZ6YK/GjmgqA+3TDNrfojtEDucVcsW4rWIpHsJcW9LT6lkQpbWoRb+P6D
            wunYZMED7YDlw1MswmIUMF/9lYKvKM1B6d0L/wSFu7Y0mmflXwF7eeMA5rSeaqbY
            OOxIOdsyxbSpNTTsSlnlJ9RoAQkCECEHtkxafTkfesvwy5InLN+H8oJMxs28JPeY
            3BLaIPkScaHhwNNl9SF5RSFRS+gtRdj77La5VDzqSP9S5jGsHJANlp8yA+UFD81y
            hoodoIbHn2dz1HO9keLW1u2xwi2Veup+v2Q=
            =f1hp
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
