apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 1
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:trHWLHQxpvqfMYuK1Ol9rNn3DA+3Fsyo1tvDSXcBGtg=,iv:5CxAgnJA7RERbNfnFx1O5hGQCfqS4exs0Y8Jh+O80AM=,tag:7f96xI3LIjKOV1NL0OVDYQ==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql-ha-pgpool.onedev.svc.cluster.local
            port: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:3lJpXPDo3CUfgDDIPNXk6Z7mkLYfLoV/6cF7luUxGBo=,iv:DBLU3u/LDOHYTTfIAUQ57d6G3QBywwfbv9LjNsXAFmY=,tag:H9s2xd9O86MaXUeLTZ0Iqw==,type:str]
            maximumPoolSize: "30"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T20:49:42Z"
    mac: ENC[AES256_GCM,data:qAIGLlhdY3Y4Y6hB5H6XKQBwd0mE+wF+puUdUIe5UC6tqchqV8WGPD+3LIr/a6aAKy4Cz4KjNX4wQU0zEOb819OSZOIYRcIfibR7Xy3aDXATHYakS6NPIiISnyuO2zGiSwyzf16XHOIUxO8Fa5oNGt1lPyF2OphEdU/rEkmIshs=,iv:M4INw9kvNppTANNPYACL4F2unZjtpL34iDc5ev5meSA=,tag:oJoEYI1Lu+zmbTsrrUajow==,type:str]
    pgp:
        - created_at: "2024-04-07T20:49:42Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMECfszapzAKDzOCrpxoNuCC+YM1Hy0aogexEiIGigESuOh
            OWryoiBEvLe1ovzOvPeqBzA9cFHbx+k7HbSxtrW84N0WRvy2y4wiZHea38ZnzBJ6
            ySYQM0S8a6x3HOusfOJPMDQS35YIuZ8A92ZESIoZo0igs602Je34WBuudaRQvMqU
            tSflM5770lR3I1zlonqhLtRoAQkCEFr9eH4FovxE/pxkozSUdlqGyDkAkWHs1ZGQ
            J6ZZ5Gz6r2lOVwmX3pNh0xT9QeKFKcLicO+CgwQ2yn9tdwuvSN6b1YIwdkN2yUDK
            onzr0Ga9sOpQATlrdiNQHnLofnbgPUW5TkA=
            =2SVo
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T20:49:42Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEpNlSIaxdiks+gkRgL6Rh6GC+yyiuS6QTtppZMA6i00g7
            WNnXqmRuc5EA/tx1D2NLJIdw9Anoq0jK1DeJT3VnVlWxGBZmifL8fU9ddAPS+bYD
            J5Xq7N6CUJ/y8jRK51fnMNLwa2mz6roiH4PMKDED2yjdB8o4LT3GRBqd+FlHL8fv
            eYTMizNpeqh/lNExAJK2UtRoAQkCEMCtLN/GPCP/FsVFpN1GixyL+8W2bVkMsPsS
            klv8DBvzoqJdFSb6PV1HuGDQ0nL01IZeXzPHWIMEjLbk8L3bE9vQaXF62ZyMPRJY
            EsRn0RwZ9XyvgILGfMn/tbDHKgTkKdgdMRo=
            =R91V
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
