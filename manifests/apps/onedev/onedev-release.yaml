apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 1
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:MtlRzzCC9A/mgJH/8gKAKkJAjxmltvQPaEtWPaXdppM=,iv:XP9IB4vSJBkaGuKc0E1QUGQ5tKyhSh3wYtiVmI1LlnE=,tag:NNjZgpjiFeWsPH5v0m8AGg==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql-ha-pgpool.onedev.svc.cluster.local
            post: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:UW8dmeKfWZPuXGLEvqCe2+BiP8pR6DDZSLYUkarQSO4=,iv:J5ZDeeaNh3YVKaQMt4bwzQDUvRmgQ4AORBDr8+QEQvk=,tag:yEWm3pl3kfQ3JI8/XYh6kQ==,type:str]
            maximumPoolSize: "200"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            annotations:
                traefik.ingress.kubernetes.io/service.sticky.cookie: "true"
                traefik.ingress.kubernetes.io/service.sticky.cookie.name: glue
                traefik.ingress.kubernetes.io/service.sticky.cookie.secure: "true"
                traefik.ingress.kubernetes.io/service.sticky.cookie.maxage: 3600
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T20:15:07Z"
    mac: ENC[AES256_GCM,data:OeOTZSeYzFdRdv3iWWDVqCRMy2fw92Qw91WjAWSliThUV0NHq25NNP+VuiJlHvtGOcbA5z0w2QVOtmE1BY39z/RfHms3uBKdrEeMJlWEcEv1XWfz8BulKBSk2+NaDgsRyh9m5wTAmTl0dRcfI73mqLwCBo3jAqG8ZuiXAE6Xl50=,iv:y0A/knztOonVODr5CW+8iUxgV7OQ39Z/iDC3tSFzSXc=,tag:00LL9yIYUGK38S/SJWSFkA==,type:str]
    pgp:
        - created_at: "2024-04-07T20:15:07Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEyXAZjLjuU7sBXZDwrx0ckKZdFj8dv+vehThIlemrKXhv
            wvy7TZvGojSjN80RDcrKqdbUR3lHQZZepQ4A6pEi3tKiqHRr0qgviTWJMDQYXtm4
            lBKNJuHX1RJ0cz5PSUk4MLGQbnvLwpZIAEC70t3J5Ow96U6LVlPnygQaGgfpZP2Q
            F7TTGy4krvqOxk8cb/WHftRoAQkCEI6hMOSzV8Xz7ZFBFogKnzqxIxG0H1oJuSw8
            mgUcdu2GBpA896S2pSrfwv4i5eSItlj75I3WKVotFfAeK8ec59jKMsJljuA/qiIA
            JuQsPu6cB6azLPtNhCCs+fMGExF95GbQWOo=
            =8Rp0
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T20:15:07Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEQX9sU+I5PBnpYbX++peCCWngv88/UdQ2nr13TTCO6w8S
            jDtF+EYOQiZ/MJlx6EYGBPlbsHC4g6NffRC5pfo5XJkjvTwzpCXAo/7oArp7xeDG
            BeA5EAUhme1ToEmtglJqME+KXnUcKoxS1INy8IcOH+dZnNiykl2ci8m6ry5Cm6yb
            cLIj0dO66t4o8xly3+zFAdRoAQkCEPKaF+uJ6/Dh+IzdxFkppfdj4id1WxSnt7mG
            HrawVOVGRUI2SpX+e4M5UbJIFGik3JrOot8zl7UCBQe3HB8yBmb9trpLIp8hmsPE
            /KJmCNrwfh2u2FmV6ye2VvwG96EJtHtBIco=
            =8S/h
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
