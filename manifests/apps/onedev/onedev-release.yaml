apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 3
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:iKFrv53RRVW5qVnZIdnaUscl8URfNkmd2QqlpKQzWVo=,iv:oTEeD9N8WIThU0sholr//Rk5f0i3cMJT25wgJLbOHRg=,tag:1Wwtxl0KexPNPrwNFQeHGg==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql.onedev.svc.cluster.local
            port: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:Jh6i0ctIkJDbdhdHeJ0qTTGXVATUlMjV9v+n+O7B8IE=,iv:768vLC+1nzRUXr0Ns3zq5xvFwQKk8iUOywXn42txiXY=,tag:/0fqRPSkR7XX78BftPfCTw==,type:str]
            maximumPoolSize: "30"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            annotations:
                traefik.ingress.kubernetes.io/service.sticky.cookie: "true"
                traefik.ingress.kubernetes.io/service.sticky.cookie.name: glue
                traefik.ingress.kubernetes.io/service.sticky.cookie.secure: "true"
                traefik.ingress.kubernetes.io/service.sticky.cookie.samesite: strict
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T21:14:56Z"
    mac: ENC[AES256_GCM,data:Qzc+PHEE84MtDcjZ/7btAkQYA6gUgBFhDN7mEwdtDIGlquFoSrHcEllKXCQRIRE3jMviHvf4ywc/ax1Kg1RIGfaZ28U0/Xwt2dXbBRKRXlgDyVReixybgJboN++cA1MnUkzY+3rcd2hJtg5XZhNRJOpNRWznxZldR2EuWwbpJO4=,iv:94hbbOZngsczFziuWCJlJnDucp8SwMX60a5RV7BOYzc=,tag:oBgvwLE6MAsfRYBknAfvVQ==,type:str]
    pgp:
        - created_at: "2024-04-07T21:14:56Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwME7mu89xqWs7HIESaOUQEt4VEbPbmeM3whbpF7UwvGils0
            h6y7ocAzqjX4dL9Kxj92Fc3xkGjsV/ttdVKM1wpmL8FbnLzhENSx9RMvVOvJ5/59
            DD207zamnhMk1piEFkkJMAxfHTAjP3tiC0FpR7xAAzuzSHPtxItg14p3ZNXy0hdg
            ui7JC0kTGz3RTgsIUKv81tRbAQkCEMzGEbbVUhgpSo/sO2LWXaRsEV1SfaEG6o4X
            7ajdZ7v1xWKfz9bsV/af0gHIFtMkaNOL8MbpvalPfxDA1okKFrBFX9EYuzUxt9y/
            wF1i3Qk0L/kNO835mw==
            =VkBB
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T21:14:56Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMERtzPexjb/ec45O0rPATxfBEz4wlVJ2/Bqi0wmgSKZVes
            947tcxuO+huVc5ixqiCe+Kf7xZKOy6wFbHEIzWeyHs+fWEyywfFrEFnj8SRU+f3W
            +uOkNQllMhWECmI+0oMbMEwTOnmbEdcAf5ZwEN8b+BH8CJy6rx15JF3swZtrqha/
            Vf4XItYDVThEZ7fynEkXOtRbAQkCELEElYldSAVOSxMrSDd+n/vnYxe/9MwybaFb
            UkurmKvJ0OQWdar+rhmWb6Clk+Pv6rMqmXVjQnzSCKeZMM0ZBcMP0LT0ehu3hDjX
            JmrhcqaEQ0W0WVsGCQ==
            =8zRi
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
