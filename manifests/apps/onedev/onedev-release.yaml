apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 1
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:XLEj7mAN3rPxjEa9RFJpjKANloBn5lTdQ+WuukryqA8=,iv:cTlB2O+b/hcxrvG9cTu5KgCmyrtIHPI2DOl6ZG3cjD4=,tag:4ncmrTw6lhMcCFOhn7hcYg==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql-ha-pgpool.onedev.svc.cluster.local
            port: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:GgVSUDsoXEWnNZYDF3juKuaQGpHjFdeP0fG6EjXRulI=,iv:/M3In15OaHfjEeNAygXvr8Hphr+nJzcln3YgadSOlGs=,tag:0k5zKp4zR3CvnXSgdfra9Q==,type:str]
            maximumPoolSize: "200"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T20:40:45Z"
    mac: ENC[AES256_GCM,data:ng15z4EUhk0YfpY+eJjpnBjAUhCeIAdjvYIlMnwdNUnCPz0jqlvkaRSHvloAS/mkkieNv7mxnx63I4T4uwLej3faXeLaBgEIV7Z3bdYcDQo8l8S5iwJSv1DRRaTCJ/HyaLhSUWZlH9yu3piInSL4MYAxsIq4Cl+SN3dehowwxxE=,iv:Gf83UQCiosdGZ7VlyKH56cs6Kbtzj9WPP0x9F2C487s=,tag:A6vef94t/PsPYZiXInT9wA==,type:str]
    pgp:
        - created_at: "2024-04-07T20:40:44Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMESkj4Bqdwjfbkd0qL1iar4ZAM+WzzSkHKHHpjL2XsWr4r
            Q5wanplx2SInrsewnywcp8ebG9jybQ5eWGR/L7a6T2sC6woY2vc8jW10SmDTenlg
            U5/oqxSr5Oc63l/B9u/DMCX0m0MOojU2/a+9BaxlnJA05lHncJs64YMwLvHRi5eY
            RPzhFBOotvdMK86IkQP+TNRoAQkCEDVEvkf733+lt5EspbhAnTNDLek2WWBCYet0
            iqmtiPxD2xHaWai9o0y+vYCLCmAwwpbIzRXuOetpElHXhGFDsQGoFhnphGFY+jK8
            SwXaYo8tPb5Osm1Ut1jIJtibvYKNjaHGB4E=
            =RQgE
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T20:40:44Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEsOqR6Q+tlcCyKKTm67qH1zvFBDO9AgfrIm5O/SugRCzm
            txyM890rezVrCuRDB9bINCjk6k85tH4+DreSYHmZUgDOqcoiAeNFjXA0Nu4eDc6g
            mB/G1j2aOV0JcUMJrC9SMPi2FI2xJt0SK/fWgeeB/Rdbv9lj3BneEeOfKVoEphwf
            OZ4+IqHreH7OguvudwNeDNRoAQkCEALqdZwBy08OMezxd7mIaqJSRubLpWcBHrbK
            S5Tg0upGKpsAxTblu8pWH6Lye9ZZ4HvEdzm2HrMVYsRrGXTVt6AnKvmPcjYIynLr
            dDRb7Q4BKnCZjStHFkBejdFrmGyAu9To/vw=
            =DTiE
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
