apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: onedev
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: onedev
            version: '>=10.4.0 <10.5.0'
            sourceRef:
                kind: HelmRepository
                name: onedev
                namespace: onedev
            interval: 1m
    values:
        onedev:
            replicas: 1
            initSettings:
                user: admin
                password: ENC[AES256_GCM,data:RR2JDFi5gpYh7fk0eZE8b8n7Lm3efHc+Ic/UOpuw+nw=,iv:QZhHoP4t4xvVYxSXNI/UH7291KhWPjS2K2aK8io4RWo=,tag:aDaNdAB5Ew50OYRjNR9Xvg==,type:str]
                email: webmaster@omnilium.com
        database:
            external: true
            type: postgresql
            host: postgres-postgresql-ha-pgpool.onedev.svc.cluster.local
            port: "5432"
            name: onedev
            user: onedev
            password: ENC[AES256_GCM,data:cp0seFGCg3rn1+YtYhi+TXTARlO+RhmxWpEnkjGTRE8=,iv:Vxp9GCNdg7LckwS2qDSwPXai4Qn0dlnV1X4yanVqNek=,tag:tMvFjjcLHUDttz+IGGGvFQ==,type:str]
            maximumPoolSize: "30"
        podLabels:
            app.omnilium.local/identifier: onedev
        resources: {}
        affinity:
            podAntiAffinity:
                preferredDuringSchedulingIgnoredDuringExecution:
                    - weight: 100
                      podAffinityTerm:
                        labelSelector:
                            matchLabels:
                                app.omnilium.local/identifier: onedev
                        topologyKey: topology.omnilium.local/host
        topologySpreadConstraints:
            - labelSelector:
                matchLabels:
                    app.omnilium.local/identifier: onedev
              topologyKey: topology.kubernetes.io/zone
              maxSkew: 1
              whenUnsatisfiable: ScheduleAnyway
        service:
            separateSSH:
                enabled: true
        ingress:
            enabled: true
            annotations:
                cert-manager.io/cluster-issuer: acme
            host: git.omni.ms
            tls:
                enabled: true
                secretName: onedev-tls
        persistence:
            storageClassName: replicated
            size: 20Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T20:55:00Z"
    mac: ENC[AES256_GCM,data:SrVOKQAr5kpmMNzCN+qURm/TCaJXYS1xs/zyXFruiVjCd0PmBnCNUrgenX85nNpaGSJTZzGdfcjltzNXtHvdlCZLZhdB8sMHFPmB+jBZ+J+xPgouX6uyHzDyZHYyzm8SiAUYc8LwowQPYAfszkRtmixhSN3Mc78xJQNo5z/fQlU=,iv:hPT61cTF/eYdQgrzulrqqXOONfTDnFa7cBeoOfO2FF0=,tag:ux4b55xmUqMSTyKNKZYDiw==,type:str]
    pgp:
        - created_at: "2024-04-07T20:55:00Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEaBemZ1DQHqpZWTya2ryBYnW1I8YkHBEFyHla/uFt8QZ3
            7vQkPI53GafxRLoJ0MmH3OgudhCYcRd8DiC45bAFp+KqSzMcGfjiU96vvfCmvm2U
            sCZo4bARyX9dHraPf1Z/MBytzpfUOY0vhQxxDf3nBecOuOYJkkXYmrGzDlRx5pba
            YAHdFPmJzIVGLHeW7OVkkNRoAQkCEPNBPv3LwnKtz36HCP5AbD4+u7bd+ewDCBu2
            iBRYx0egf3iJBiQ5v+OKPl7KTtosXqULSGgcoo4t7vSIJIexm7Mv7nkq+79hySTL
            cMBtEfzoHtthoXQm5ICuAqMW/1SJJkkyqa8=
            =0Kg+
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T20:55:00Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwME11UIRdgNNd7njmliIf2d32bf+Z4taEhB+bq5rw9ug8Ri
            HH1JHkoT4lgvIQaAeLaqmG5sIehL4cjirGDS30QhbRAMu0rsvkyjkBxfxjXlP+FZ
            TDbICzotA4eeUw6PpfTrMCucUL0mepve4tIUYFfE9sWpJfMgMr1NDMcKW3Vvz8pc
            VcD0cvIsABS9wKyukN61tdRoAQkCECREulWKWTERDUI3luMHJZ+6YZVlrPDzeu10
            w8dr7yQwhZNjSDWX2Q/3nTb1aJgSRLouh+OUVsF3ZSXiUeP89bUgRXWPHCgpKicr
            mt0ZLARsAz3hn5GV6KmHJWVzSvA8MReSu3c=
            =IEiO
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(data|stringData|password)$
    version: 3.8.1
