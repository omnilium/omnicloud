apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: postgres
    namespace: onedev
spec:
    interval: 10m0s
    chart:
        spec:
            chart: postgresql
            version: '>=15.2.4 <15.3.0'
            sourceRef:
                kind: HelmRepository
                name: bitnami
                namespace: onedev
            interval: 1m
    values:
        global:
            postgresql:
                auth:
                    username: onedev
                    password: ENC[AES256_GCM,data:Bk1vDNh5mvZN3b1JoTmsTFZRX8LpcxGDDn/N7JVWvhs=,iv:6ntIDJzZG6auUeGkcENlDih54mmCwtWpWwhHoQRaNuE=,tag:YU2zurPhs5WUDdtoAbzzmw==,type:str]
                    database: onedev
        auth:
            enablePostgresUser: false
            username: onedev
            password: ENC[AES256_GCM,data:r2bQRgpkOouK4MAU4xEBoofrIZROcGqyBXuTus3E+4k=,iv:0Z0TCjd3dOmGrUfS/rVua0TsNfJZPXnqCe1wIZRJou0=,tag:FcYKFoQAiNDDRKPKFL9aeg==,type:str]
            database: onedev
            replicationPassword: ENC[AES256_GCM,data:R4dw/DQH1AHa7/ZUkTKpjwVa9hmJNc5zdoOWrL1mbfz8MoDOyl1bOS9xgUQ=,iv:ikwrFMU42hIo3RCnt8K/n1D8SiaUZcKGhcST4u8fQ1A=,tag:JxJb078/jVGUmtYk5BdyWA==,type:str]
        primary:
            resourcesPreset: medium
            podLabels:
                app.omnilium.local/identifier: postgres-onedev
            affinity:
                podAntiAffinity:
                    preferredDuringSchedulingIgnoredDuringExecution:
                        - weight: 100
                          podAffinityTerm:
                            labelSelector:
                                matchLabels:
                                    app.omnilium.local/identifier: postgres-onedev
                            topologyKey: topology.omnilium.local/host
            topologySpreadConstraints:
                - labelSelector: null
                  matchLabels:
                    app.omnilium.local/identifier: postgres-onedev
                  topologyKey: topology.kubernetes.io/zone
                  maxSkew: 1
                  whenUnsatisfiable: ScheduleAnyway
            persistence:
                storageClass: replicated
                size: 10Gi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age: []
    lastmodified: "2024-04-07T21:04:29Z"
    mac: ENC[AES256_GCM,data:WLD/7T9FN0os1+ALsB56uFxLGh8ZXjwYTkeA3iCl9Mnj8y4vOUHQBeqN554oWtIiVCNSi/x8zHCz7fmzp0ESypHRXs12r9rKgnNg/F2NIN7pZEHcB+/PQLbI0Dld2KjfblR8701MOS3ceLWePBBO9s50dL0apZwwfZjOTIfYrNg=,iv:X4aENO92MuKwjDIurBzYWunXZykuMvLit1qZEfEZ5Hc=,tag:Db0WYoWiSdNSOKXy4u8FZw==,type:str]
    pgp:
        - created_at: "2024-04-07T21:04:29Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4D0dRkdsWQFPUSAwMEEAB73Dx3AVDJCPzPhYXglL92gj6vG0h2SjwH8A60fpSU
            JBkMeKon2v1O4MhhMzpFfYm9SiwZxQQ/j699sa0uOmXueZI4Yv0NvLeDAm/RM5m7
            D2137vUXXYlelYJFzKEwMNejo7XfTE3YI1RBtQ+ETZQvkN5ltvV5EfnFPYmva2B3
            az//jOshoGBp2pTLAwhVeNRmAQkCEINqDVqwOZsC3MQbquI10z2BxkacCAFqLQJd
            CzDVqOM8Kh61BZI6UfNaMHTUyEru4+f6vAXI66pxNIg2zildgAMTBqAMPKEfXplA
            epuMajv2mZt9q7ygmpHCsLSvQ4Onslpr
            =PbeV
            -----END PGP MESSAGE-----
          fp: 0F003E832B1DA1A11CA9F206712F90FA248BBBC2
        - created_at: "2024-04-07T21:04:29Z"
          enc: |-
            -----BEGIN PGP MESSAGE-----

            hJ4DLG005yzvDc8SAwMEnAy0t0fh8Q11C/ey6bAzM7RSSV4sZ0n69HbkXvpd1Hbl
            9ELJrt31Us49tLKpdRegSNV2eXAi7DURjZilqv+j9/4cskF2SdlHGzTa2dEcHEJ8
            zdvWRiT/Be3I63pgC28mMDweJx75yciMVsWzPX9Xb5F2IzjcX1svMk/3hM0FkblG
            wd8o6Lvbbj4IWMJ+yp8AxtRmAQkCEA1wtbxcjPWfkgvU+72w36WlbozZRtxFrmqk
            i4ONeiv/CAc3HBMSVmEhcbjxN8xV3d7VfEB5Bwd5U8CEIi2329CnEaJdj1pccTTx
            cVgYsqMUhW7qRX8JKGBKsvnCEvLgvoWn
            =/z7a
            -----END PGP MESSAGE-----
          fp: 1918B94484C52CDE42CA1B87E7812096B8DA4A52
    encrypted_regex: ^(password|replicationPassword)$
    version: 3.8.1
